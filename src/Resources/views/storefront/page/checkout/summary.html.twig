{% sw_extends '@Storefront/storefront/page/checkout/summary.html.twig' %}

{% block page_checkout_summary_inner %}
	{% set discountSummary = page.extensions.strix_discount_summary ?? null %}

	{# Subtotal before discount as the first row #}
	{% if discountSummary and discountSummary.preSubtotal > 0 %}
		{% sw_include '@StrixNLUxUpgrades/storefront/page/checkout/summary/summary-pretotal.html.twig' with {
            'preSubtotal': discountSummary.preSubtotal
        } %}
	{% else %}
		{# Original Shopware subtotal row #}
		{% sw_include '@Storefront/storefront/page/checkout/summary/summary-position.html.twig' with { 'summary': summary } %}
	{% endif %}

	{# Discount row, only if discount total is greater than 0 #}
	{% if discountSummary and discountSummary.discountTotal > 0 %}
		{% sw_include '@StrixNLUxUpgrades/storefront/page/checkout/summary/summary-discount.html.twig' with {
            'discountTotal': discountSummary.discountTotal
        } %}
	{% endif %}

	{# Rest of Shopware's summary logic remains untouched #}
	{% sw_include '@Storefront/storefront/page/checkout/summary/summary-shipping.html.twig' with { 'summary': summary } %}

	{% if summary.price.taxStatus == 'gross' %}
		{% sw_include '@Storefront/storefront/page/checkout/summary/summary-total.html.twig' with { 'total': total, 'decimals': decimals } %}
		{% if displayRounded %}
			{% sw_include '@Storefront/storefront/page/checkout/summary/summary-total-rounded.html.twig' with { 'summary': summary, 'decimals': context.totalRounding.decimals } %}
		{% endif %}
		{% sw_include '@Storefront/storefront/page/checkout/summary/summary-net.html.twig' with { 'summary': summary } %}
		{% sw_include '@Storefront/storefront/page/checkout/summary/summary-tax.html.twig' with { 'summary': summary } %}
	{% else %}
		{% sw_include '@Storefront/storefront/page/checkout/summary/summary-net.html.twig' with { 'summary': summary } %}
		{% sw_include '@Storefront/storefront/page/checkout/summary/summary-tax.html.twig' with { 'summary': summary } %}
		{% sw_include '@Storefront/storefront/page/checkout/summary/summary-total.html.twig' with { 'total': total, 'decimals': decimals } %}
		{% if displayRounded %}
			{% sw_include '@Storefront/storefront/page/checkout/summary/summary-total-rounded.html.twig' with { 'summary': summary, 'decimals': context.totalRounding.decimals } %}
		{% endif %}
	{% endif %}
{% endblock %}
